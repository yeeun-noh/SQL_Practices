--4일차

--집계 및 그룹함수: COUNT(), SUM(), MAX(), MIN(), GROUP BY, HAVING
--COUNT()
SELECT COUNT(*)
FROM EMPLOYEES;


SELECT COUNT(*)
FROM JOBS;


--SUM(), AVG() : 총합, 평균
SELECT SUM(SALARY), AVG(SALARY)
FROM EMPLOYEES;


--위와 결과값 같음:
SELECT SUM(SALARY)/COUNT(SALARY)
FROM EMPLOYEES;


--이름을 기준으로 급여 누적 합계를 구함:
SELECT FIRST_NAME, SALARY, SUM(SALARY) OVER (ORDER BY FIRST_NAME) AS 누적급여
FROM EMPLOYEES;


--MAX(), MIN()
SELECT MIN(SALARY) AS 최소급여, MAX(SALARY) AS 최대급여
FROM EMPLOYEES;


--STDDEV(), VARIANCE() : 표준편차, 분산
SELECT STDDEV(SALARY) AS 표준편차, VARIANCE(SALARY) AS 분산
FROM EMPLOYEES;


--GROUP BY : 일반함수랑, 집계함수는 같이 못씀 => GROUP BY +일반함수 사용해야 함!
--JOB_ID별로 총점, 평균 집계:
SELECT JOB_ID, SUM(SALARY), AVG(SALARY)
FROM EMPLOYEES
GROUP BY JOB_ID;


--DEPARTMENT_ID = 50 중에서 JOB_ID별로 급여 총액, 평균 집계:
--(EX. 영업부에서 직급별 급여 총액과 평균을 집계)
SELECT JOB_ID, SUM(SALARY), AVG(SALARY)
FROM EMPLOYEES
WHERE DEPARTMENT_ID = 50
GROUP BY JOB_ID;

-- 부서별 최소급여, 최대급여 집계:
SELECT DEPARTMENT_ID, MIN(SALARY), MAX(SALARY)
FROM EMPLOYEES
GROUP BY DEPARTMENT_ID
ORDER BY DEPARTMENT_ID;


-- 부서별 최소급여, 최대급여 집계(단, 입사일 2007년 이전):
SELECT DEPARTMENT_ID, MIN(SALARY), MAX(SALARY), HIRE_DATE
FROM EMPLOYEES
WHERE HIRE_DATE >= '20070101'
GROUP BY DEPARTMENT_ID, HIRE_DATE
ORDER BY DEPARTMENT_ID;


--부서별, 직급별 급여총액, 급여평균 집계:
SELECT JOB_ID, DEPARTMENT_ID, SUM(SALARY), AVG(SALARY)
FROM EMPLOYEES
WHERE DEPARTMENT_ID BETWEEN 50 AND 100
GROUP BY JOB_ID, DEPARTMENT_ID
ORDER BY JOB_ID;


--HAVING: 일반함수는 WHERE 사용, 집계함수는 HAVING 사용!
--급여총액이 50000만이상 데이터만 집계:
SELECT DEPARTMENT_ID, SUM(SALARY), AVG(SALARY)
FROM EMPLOYEES
GROUP BY DEPARTMENT_ID
HAVING SUM(SALARY) >= 50000
ORDER BY DEPARTMENT_ID;


--DEPARTMENT_ID별 급여 최대값, 급여 최소값 집계(단, 급여 최대값 10000이상):
SELECT DEPARTMENT_ID, MAX(SALARY), MIN(SALARY)
FROM EMPLOYEES
GROUP BY DEPARTMENT_ID
HAVING MAX(SALARY) >= 10000;